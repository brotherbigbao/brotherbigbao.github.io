# autossh 使用
> autossh 使用

## 原写了个脚本使用ssh本地端口转发，发现经常会断开

```shell
#!/bin/bash
vpnpid=$(ps -ef | grep "ssh -NTf -D 7070 root@YOUR_SERVER_IP" | grep -v grep | awk '{print $2}')
if test $vpnpid
then
echo "发现已有端口转发: $vpnpid."
echo "现在开始kill."
kill $vpnpid
else
echo "没有发现已存在ssh端口"
fi
echo "开始创建新的连接"
ssh -NTf -D 7070 root@YOUR_SERVER_IP >/dev/null 2>&1
ps -ef | grep ssh | grep -v grep
```

以前有了解过 autossh，但没有使用过，就将上面的命令改成这样，发现可以很好的自动重连

```
autossh -M 7090 -NTf -D 7070 root@47.242.76.202
```